---
title: "Basic R"
output:
  html_document:
    theme: cosmo
    toc: yes
  pdf_document:
    toc: yes
editor_options: 
  chunk_output_type: console
---

<!--
IMAGES:
Insert them with: ![alt text](image.png)
You can also resize them if needed: convert image.png -resize 50% image.png
If you want to center the image, go through HTML code:
<div style="text-align:center"><img src ="image.png"/></div>

REFERENCES:
For references: Put all the bibTeX references in the file "references.bib"
in the current folder and cite the references as @key or [@key] in the text.
Uncomment the bibliography field in the above header and put a "References"
title wherever you want to display the reference list.
-->

```{r general_options, include = FALSE}
knitr::knit_hooks$set(margin = function(before, options, envir) {
  if (before) par(mgp = c(1.5, .5, 0), bty = "n", plt = c(.105, .97, .13, .97))
  else NULL
})

knitr::opts_chunk$set(margin = TRUE, prompt = FALSE, comment = "##",
                      collapse = FALSE, cache = FALSE, autodep = TRUE,
                      dev.args = list(pointsize = 11), fig.height = 3.5,
                      fig.width = 4.24725, fig.retina = 2, fig.align = "center")

l <- "en_US.UTF-8"
Sys.setenv(LANGAGE = l)
Sys.setlocale(locale = l)
Sys.setlocale("LC_MESSAGES", l)

# cleaning the packages space:
search_path <- search()
pkgs <- c("stats", "graphics", "grDevices", "utils", "datasets", "methods", "base")
tdet <- grep("package", search_path[!(search_path %in% paste0("package:", pkgs))],
             value = TRUE)
for(i in tdet) detach(i, unload = TRUE, character.only = TRUE)

rm(list = ls())
```

## R as a calculator

```{r}
1 + 2
3 * 4
5 / 6
7 - 8
```

## Variables

Creating variables:

```{r}
a <- 1
b <- 2
c <- 3
```

Listing the variables in the environment:

```{r}
ls()
```

Seeing the content of a variable:

```{r}
a
```

Removing a variable:

```{r}
rm(a)
```

Checking that variable `a` has been removed:

```{r}
ls()
```

Removing several variables at once:

```{r}
rm(b, c)
```

Checking:

```{r}
ls()
```


### Vectors

Basic data structure in R is vector with is and **ordered** collection of 
elements, all the same nature:

```{r}
a <- c(1, 2, 3)
b <- c("a", "b", "c")
```

Selecting elements:
```{r}
a[1]
b[2]
```

Negative selection:

```{r}
a[-2]
# is the same as
a[c(1, 3)]
# and
b[-3]
# is the same as
b[c(1:2)]
```

Additional function to use on vectors:

```{r, eval = FALSE}
length()
head()
tail()
seq()
```

### Data frames

Whereas vectors are 1-dimension structure, data frames are 2-dimension 
structures (they have rows and columns). A data frame is basically a collection
of vectors (organized in columns), all of the same length (the number of rows).
To create a data frame:

```{r}
mydf <- data.frame(name   = c("george", "bob" , "edwin", "richard", "lisa"),
                   gender = c("male"  , "male", "male" , "male"   , "female"),
                   age    = c(23      , 18    , 43     , 21       , 50),
                   stringsAsFactors = FALSE)
```

It looks like this:

```{r}
mydf
```

To positively and negatively select values from a data frame, it's the same as
for vector (i.e. square brackets), except that here we have to provide indexes
for rows and columns separated by a common. Rows are always first. Examples:

```{r}
mydf[, 2]
mydf[3, ]
mydf[-3, ]
mydf[2, 3]
mydf[2:4, c(1, 3)]
mydf[2:4, -1]
```

Reading an excel file:

```{r eval = FALSE}
readxl::dengue2010 <- read_excel("name_of_the_excel_file.xls")
```

### Lists

Lists are a collection of elements which, unlike vectors, do not need to be all
of the same nature. Furthermore elements of a list can themselves be lists,
which give lists the property to be structured objects.

```{r}
my_list <- list(1, 2, 3)
my_list
```

Same as for vector, if you want to select elements of a list, use the single
square brackets `[]`:

```{r}
my_list[2:3]
my_list[-1]
my_list[1]
```

In case you select only one element of the list, you may want to drop the list
structure that you may not need any more. For that, use the double square
brackets `[[]]` instead of single square brackets `[]`:

```{r}
my_list[2]
my_list[[2]]
```

Same as for vectors, you can name the elements of a list:

```{r}
my_list <- list(first = 1, second = 2, third = 3)
my_list
```

And you can use these names instead of indexes to select the elements of a list:

```{r}
my_list[1]
my_list["first"]
my_list[c(1, 3)]
my_list[c("first", "third")]
```

Finally, a very useful function to use on list is the `with()` function: it 
tells, in what list R should be looking for the elements you are talking about.
Exammple:

```{r eval = FALSE}
first + 1
```

returns an error because by default R look for objects in the global 
environment, and there is no such object named `first` in the global 
environment:

```{r}
ls()
```

If you meant the element of the list `my_list` named `first`, then, you can
specify it this way:

```{r}
my_list[["first"]] + 1
```

Note here that we dropped the list structure by the use of the double square
brackets `[[]]`. An alternative to the above command is to use the `with()`
function:

```{r}
with(my_list, first + 1)
```

Here, `with()` tells R to look for an element named `first` in the list named
`my_list`.

#### Advanced

Two advanced points:

* Use of the dollar sign `$`

If you are selecting only one element of a list, then, the tree commands below
are equivalent:

```{r}
my_list[[2]]
my_list[["second"]]
my_list$second
```

* Data frame are lists where all the elements (columns) are all vectors of the 
same length. In consequence, you can also make use of `[[]]` and `$` to select
elements of a data frame as you would do for any regular list:

```{r}
mydf[[2]]
mydf[["gender"]]
mydf$gender
```


## Scripts

Open a new script file and write:

```{r}
# step 1: make a vector of 20 random values,
# normally distributed:
myvar <- rnorm(25)

# step 2: select the first 5 and the last 5 values:
myvar <- myvar[-(6:15)]

# step 3: replace the third value by 3:
myvar[3] <- 3
```

Save the script in `vector selection.R` and source it:

```{r, eval = FALSE}
source('vector selection.R')
```




